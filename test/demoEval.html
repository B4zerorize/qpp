<html>
<head>
  <title>Querypoint Demo</title>
  <script>
  function request(method, url, callback, errback) {
    if (!callback || !errback) {
      throw new Error("Both callback and errback functions are required");
    }
    var xhr = new XMLHttpRequest();
    xhr.open(method, url);
    xhr.addEventListener('load', function(e) {
      if (xhr.status == 200 || xhr.status == 0) {
        if (DEBUG) 
          console.log("end xhr "+url);
        totalCallback++;
        callback(xhr.responseText);
      } else {
        if (DEBUG) 
          console.error("err xhr "+url);
        totalErrback++;
        errback(xhr.status);
      }
    }.bind(this), false);
    var onFailure = function() {
      errback.apply(null, arguments);
    }.bind(this);
    xhr.addEventListener('error', onFailure, false);
    xhr.addEventListener('abort', onFailure, false);
    totalRequests++;
    xhr.send();
  };

  function onSuccess(content) {
    var src = content + '\n//@ sourceURL="demo.js"\n';
    eval.call(window, src);
  }
  function onError(err) {
    console.error("Failed "+err, err);
  }

  request('GET', 'demo.js', onSuccess, onError);

  </script>
</head>
<body>
  <h1>Querypoint Demo</h1>
  <p>Users of this Web page are complaining: the button does not count the number of clicks correctly. 
  Can you find the bug? 
  Start on line 22 of <code>demo.js</code>
  and only use Querypoint debugging.  
  Don't read all of the source, imagine this program was many thousands 
  of lines and you are paid by the number of bugs you find.</p>
</body>
