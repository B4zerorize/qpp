<!DOCTYPE html>
<head>
    <!-- These files are equivalent to devtools_extension_api.js -->
<script src='chrome-extension://ggimboaoffjaeoblofehalflljohnfbl/WebInspectorKit/Source/WebCore/inspector/front-end/ExtensionAPI.js'></script>
<script src='chrome-extension://ggimboaoffjaeoblofehalflljohnfbl/WebInspectorKit/Source/WebKit/chromium/src/js/DevToolsExtensionAPI.js'></script>
<script src='chrome-extension://ggimboaoffjaeoblofehalflljohnfbl/atopwi/buildExtensionAPI.js'></script>
<!-- RPC Wrapper for chrome.debugger.sendCommand -->
<script src="chrome-extension://ggimboaoffjaeoblofehalflljohnfbl/atopwi/remoteDebugAPIGeneration/generateProxyDebugAPI.js" ></script>
<script src="chrome-extension://ggimboaoffjaeoblofehalflljohnfbl/atopwi/buildDebuggerProtocol.js" ></script>

<!-- External Libraries -->
<script src="../keymaster/keymaster.js"></script>
<script src="../jquery/jquery-1.8.2.js"></script>
<script src="../knockout/knockout-2.2.0rc.debug.js"></script>
<script src="../mirror/CodeMirror/lib/codemirror.js"></script>
<script src="../parseuri.js"></script>
<script src="../ChannelPlate/ChannelPlate.js"></script>
<script src="../ChannelPlate/RemoteMethodCall.js"></script>
<script src="../ChannelPlate/XHRInBackground.js"></script>

<script src="../DebugLogger.js"></script>
<script src="addEventFunctions.js"></script>
<script src="../Model/PanelModel.js"></script>
<script src="../Model/Storage.js"></script>

<script src="KeyBindings.js"></script>
<script src="URISelector.js"></script>
<script src="ElementQueryProvider.js"></script>
<script src="Log/LogScrubber.js"></script>
<script src="Log/Log.js"></script>
<script src="Log/LogViewModel.js"></script>
<script src="Editors/EditorByCodeMirror.js"></script>
<script src="Editors/BuffersStatusBar.js"></script>

<script src="Editors/Editors.js"></script>

<script src="LineNumberViewModel.js"></script>
<script src="TokenViewModel.js"></script>
<script src="TraceViewModel.js"></script>
<script src="QueryViewModel.js"></script>
<script src="TokenQueryProvider.js"></script>
<script src="FileViewModel.js"></script>
<script src="QuerypointPanel.js"></script>
<script src="OnPanelOpen.js"></script>

<link rel="stylesheet" href="../mirror/CodeMirror/lib/codemirror.css">
<link rel="stylesheet" href="../mirror/CodeMirror/theme/monokai.css">
<link rel="stylesheet" href="QuerypointPanel.css"><!-- after codemirror.css -->
<link rel="stylesheet" href="Log/logScrubber.css"><!-- after codemirror.css -->
<link rel="stylesheet" href="Editors/buffersStatusBar.css"><!-- after codemirror.css -->
<script src="../mirror/CodeMirror/mode/javascript/javascript.js"></script>
</head>
<body class="cm-s-monokai">
  <div class="panelInitialization"><span class="largeMessage">Reloading previous state...</span></div>
  <div class="panel">
    <div class='logView'>
      <span class="helpInfo">console.log and tracing status output</span>
      <div class="floaty" style="height: 200px;">
        <div class="onPanelOpen">
          <div class="hint">
            <div><button class="hint_overview">Show Overview Help</button></div>
            <div><button class="hint_documentation">Open Documentation Page</button></div>
            <div><button class="hint_feedback">Feedback</button></div>
          </div>
          <p>Initialize Querypoint Debugging</p>
          <div class="initialOptions">
            <div><button class="initialOptions_justReload">Reload Page with Querypoint Runtime</button></div>
            <div><button class="initialOptions_reloadAndTrace">Reload Page and Trace Expressions in Opened File</button></div>
            <div><button class="initialOptions_noReload">Do Not Reload</button></div>
          </div>
          <p class="noticeThis">Then reproduce your bug</p>
        </div>
        <table class="messagesByLoadNumber">
          <tbody data-bind="foreach: logViewModel.messagesByLoadNumber">
          <tr>
            <td class="loadNumber" title="Reload number" data-bind="text: load"></td>
            <td>
              <table>
                <tbody class='turns' data-bind="foreach: turns">
                  <tr>
                    <td class="turnNumber" title="Event turn number" data-bind="text: turn"></td>
                    <td class="messages" title="console output" data-bind="foreach: {data: messages, afterRender: $root.setScroll}">
                          <div data-bind="text: text, attr:{severity: severity}"></div>
                    </td>
                  </tr>
                </tbody>
              </table>
            </td>
          </tr>
          </tbody>
        </table>
     </div>
    </div>
    <div class="logScrubber">
        <span class="helpInfo">
          Log Scrubber: click or drag to change log viewport
        </span>
        <div class="loadList" data-bind="foreach: logScrubber.loads">
            <div class="loadNumber" title="Reload Number" data-bind="attr: {load: load}, event:{mousedown: $parent.logScrubber.displayLoad}">
            </div>
        </div>
        <div class="eventTurn" data-bind="with: logScrubber.eventTurn">
            <p data-bind="text: turnInformation"> </p>
            <ul class="eventTurn_summary" data-bind="if: summary">
                <li>
                    Function <a data-bind="text: summary().functionName, attr:{'data-url': summary().url}"></a>
                </li>
                <li>
                triggered by <a data-bind="text: summary().eventType"></a> on target
                </li>
                <li>
                <a data-bind="text: summary().target, event:{mouseover: highlightElement, mouseout: unhighlight}"></a>
                    <ul>
                        <li data-bind="event: {mousedown: revealElement}"><a>Reveal</a></li>
                        <li data-bind="event: {mousedown: traceElement}"><a>Trace Element</a></li>
                    </ul>
                </li>
            </ul>
            <div style="clear: both"></div>
            <div class="messages" data-bind="foreach: turnMessages">
                <p class="message" data-bind="text: text, attr:{severity: severity}">
                </p>
            </div>
        </div>
        <div class="currentLoad loadNumber" title="Reload Number" data-bind="attr: {load: showLoad}"></div>
        <div class="overviewLog">
            <!-- ko foreach: preMessages -->
            <div class="eventIndicator" data-bind="attr:{severity: severity, turn: turn}, event:{mousedown: $root.focusLog, mouseover: $root.turnInfo}"> </div>
            <!-- /ko -->
            <div class="recordMarker" data-bind="event:{mousedown: recordData.play }">x</div>
            <!-- ko foreach: postMessages -->
             <div class="eventIndicator" data-bind="attr:{severity: severity, turn: turn}, event:{mousedown: $root.focusLog, mouseover: $root.turnInfo}"> </div>
            <!-- /ko -->
        </div>
        <div class="recordIndicator" data-bind="event:{mousedown: startRecord }">&#9679;</div> 
        <div class="nextLoad loadNumber" title="Reload Number" data-bind="attr: {load: showNext}"></div>
      <!-- <span class="scrubberIndicator" title="TODO slide sideways to select visible log entries, up/down to resize log view"></span> -->
    </div>
    <div class="fileViews" data-bind="foreach: fileViewModels">
      <div class="fileView">
        <div class="hoverDoorTarget">
          <div class="hoverDoorChannel">
            <div class="hoverDoor hoverCloser"><span>Close Tracing</span></div>
            <div class="hoverDoor hoverOpener"><span>Open Tracing</span></div>
          </div>
          <div class="QPOutput overflowMe">
            <span class="helpInfo">Tracing output, see tooltips for details</span>
            <div class="tokenView" >
              <div class="scopeChain" data-bind="foreach: tokenViewModel.scopes">
                <div data-bind="html: scopeDeclaration"></div>
              </div>
              <div class="expressionView">
                <div class="currentExpression" title="Current expression trace values displayed below" data-bind="html: tokenViewModel.currentExpression"></div>
              </div>
            </div>
            <table class="traceView" data-bind="attr: {hasTraceData: traceViewModel.currentTraces() && !!traceViewModel.currentTraces().length}">
              <caption>Trace Data</caption>
              <thead>
              <tr>
                <th title="Function call within event turn, linked to source expression">Activation</th>
                <th title="Expression value during specific activation">Value</th>
              </tr>
            </thead> 
            <tbody class="traceBody" data-bind="foreach: {data: traceViewModel.currentTraces, afterRender: function(){ document.querySelector('.traceBody').scrollTop = 9999;}}">
              <tr >
                <td class="activation">
                  <span class="command" data-bind="html: iconText, attr: {title: tooltip, 'data-url': url}"></span>
                  <span title="Load number" data-bind="text: load">
                  </span>:<span title="Event turn number, 0 means initial load" data-bind="text: turn"></span>:<span title="Function call number within turn" data-bind="text: activation"></span>
                </td>
                <td class="traceValue" data-bind="text: value"></td>
              </tr>  
              </tbody>
            </table>
            <div class="queryView">
              <div data-bind="if: queriesViewModel.hasQueries">
                <div class="toolbar" data-bind="foreach: queriesViewModel.queryViewModels">
                  <button class="command" data-bind="text: buttonName(), attr: {title: toolTip(), 'data-active': isActive}, click: activateQuery.bind($data, $parent)"></button>
                </div>
              </div>
            </div>
            <a class="explainTokenPanel"  data-bind="hasfocus: tokenViewModel.followTokens, attr: {'data-active': tokenViewModel.followingTokens()}" tabindex="0">
              <div data-active="true" data-bind="css: {hide:  !tokenViewModel.followingTokens()}">Selecting Syntax Tree; Focus Editor to Lock</div>
              <div data-bind="css: {hide:  tokenViewModel.followingTokens()}">Click to Select Another Syntax Tree</div>
          </a>
          <p class="fileViewModel_syncState" data-bind="text: (currentLocation() ? tokenViewModel.tokenTree().type : 'updating')">Not Yet Updated</p>
          <!-- <div class="tracepoints">
            <p><span data-bind="tokenViewModel.tracepoints().length"></span> tracepoints in this file</p>
          </div> -->
          </div>
        </div>
        <div class="fileEditor">
           <span class="helpInfo">Editors opened with ItemSelector (control+o)</span>
        </div>
      </div>
    </div>
    <div class="buffersStatusBar">
      <div class="commandLine">
        <span>&#x1433;</span><input class="commandInput" type="search" size="100" value="Eventual home of command line">
      </div>
      <div class="counters">
        <span
          title="Number of active queries"
          class="tracequeries centeringHack"
          data-bind="text: '&#x1D5CA' + numberOfTracequeries()"
          ></span>
        <span
          title="Current load number"
          class="currentLoadNumber centeringHack"
          data-bind="text: currentLoadNumber()"
          ></span>
        <span
          title="Current turn number"
          class="turnNumber centeringHack"
          data-bind="text: '&#x21B1' + currentTurnNumber()"
          ></span>
        <span 
          title="Files changed and not saved" 
          class="unsavedChangedFiles centeringHack" 
          data-bind="text: '*' + unsavedEditors().length"
          >*1</span>
        <span 
          title="Files saved since the last reload" 
          class="savedChangedFiles centeringHack" 
          data-bind="text: '&#x2206;' + savedEditors().length"
          > 2</span>
        <span 
          title="Options changed from default values" 
          class="changedOptions centeringHack" 
          ><span class='changedOptionsIcon'>&#x2699;</span><span data-bind="text: '' +'0'"></span></span>
      </div>
    </div>
    <div class="splitter"></div>
    </tbody>
  </div> 
</body>
</html>
